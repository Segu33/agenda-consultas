extends layout

block content
  .container
    h2 Programación rápida de turnos

    form.filtros(method="GET", action="/programacion")
      .filtro-group
        label(for="fecha") Fecha:
        input(type="date", name="fecha", required)

        label(for="medico") Médico:
        select(name="medico")
          option(value="") Todos
          each medico in medicos
            option(value=medico.id)= medico.nombre

        label(for="especialidad") Especialidad:
        select(name="especialidad")
          option(value="") Todas
          each especialidad in especialidades
            option(value=especialidad.id)= especialidad.nombre

        label(for="sucursal") Sucursal:
        select(name="sucursal")
          option(value="") Todas
          each sucursal in sucursales
            option(value=sucursal.id)= sucursal.nombre

        button(type="submit").btn Buscar

    if horarios.length
      table.horarios
        thead
          tr
            th Hora
            th Estado
            th Acción
        tbody
          each horario in horarios
            tr
              td= horario.hora
              td
                if horario.estado == 'disponible'
                  span.estado.disponible Disponible
                else if horario.estado == 'ocupado'
                  span.estado.ocupado Ocupado
                else
                  span.estado.bloqueado Bloqueado
              td
                if horario.estado == 'disponible'
                  form(method="POST", action=`/turnos/agendar/${horario.id}`)
                    button.btn-agendar(type="submit") Agendar
                else if horario.estado == 'bloqueado'
                  a.btn-sobreturno(href=`/sobreturno/crear?fecha=${fecha}&hora=${horario.hora}&medico_id=${medico_id}`) Sobreturno
                else
                  | -
    else
      p No hay horarios disponibles.
      a.btn-sobreturno(href=`/sobreturno/crear?fecha=${fecha}&medico_id=${medico_id}`) Crear sobreturno manualmente
a(href=`/sobreturno/crear?fecha=${fechaSeleccionada}&hora=${horaDeseada}&medico_id=${medicoSeleccionado}`).btn-sobreturno Crear Sobreturno
